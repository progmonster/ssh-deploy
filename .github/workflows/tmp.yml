name: Tmp

on:
  workflow_dispatch

jobs:
  tmp:
    runs-on: ubuntu-22.04

    steps:
      - name: Ping Remote
        shell: bash
        run: ping google.com -c 10

      - name: Create a file
        shell: bash
        run: echo ccc >> 1.txt

      - name: Deploy to Production server ${{ vars.PRODUCTION_HOST }}
        uses: progmonster/ssh-deploy@main
        env:
          SSH_PRIVATE_KEY: ${{ secrets.PRODUCTION_DEPLOYMENT_SSH_PRIVATE_KEY }}
          ARGS: "-vi --mkpath"
          SOURCE: 1.txt
          REMOTE_HOST: ${{ vars.PRODUCTION_HOST }}
          REMOTE_USER: ${{ vars.PRODUCTION_USER }}
          TARGET: apps/1.txt
          SCRIPT_BEFORE: |
            ls -al
          SCRIPT_AFTER: |
            mv -f apps/1.txt apps/2.txt
            exit 1
            ls -al
            echo $RSYNC_STDOUT
